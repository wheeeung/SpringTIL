# MSA 아키텍쳐

### 마이크로서비스(MSA) 아키텍쳐

하나의 큰 애플리케이션을 여러 개의 작은 애플리케이션으로 쪼개어 변경과 조합이 가능하도록 만든 형태이다.

### 특징

- 각각의 서비스는 그 크기가 작을 뿐, 서비스 자체는 하나의 모놀리식 아키텍쳐와 유사한 구조를 가진다.
- 각각의 서비스는 독립적으로 배포가 가능하다.
- 각각의 서비스는 다른 서비스에 대한 의존성이 작아야한다.
- 각 서비스는 개별 프로세스로 구동되며, RESTAPI와 같은 가벼운 방식으로 통신되어야한다.

### 장점

배포

- 서비스 별 개별 배포가 가능하다.
- 독립 배포가 가능해 개발자의 자율성이 증가한다.
- 요구사항을 신속하게 반영하여 빠르게 배포할 수 있다.

확장

- 특정 서비스에 대한 확장성이 좋다.
- 클라우드 사용에 적합하다.

오류

- 오류가 전체 서비스로 확장될 가능성이 적다.
- 부분적 오류에 대한 격리가 수월하다.

유지보수

### 단점

성능

- 서비스 간에 호출 시 API를 사용하기 때문에 통신 비용 및 지연 시간이 증가한다.

데이터 관리

- 데이터가 여러 서비스에 걸쳐서 분산되므로 한 번에 조회하기 어렵다.

테스트 트랜잭션

- 단위 테스트는 쉽지만, 통합 테스트 및 End-to-End 테스트 단위로 들어가면 여러 서비스의 API를 검증해야 해서 시간과 비용이 많이든다.
- 각 서비스 별로 DB가 있어 트랜잭션을 구현하기가 쉽지않다.

개발 및 관리가 어렵고, 비용이 많이 든다.

### 내부 아키텍처

내부 서비스와 관련된 아키텍처로, 내부의 서비스를 어떻게 잘 쪼개는 지에 대한 설계이다.

내부 아키텍처는 비즈니스, 서비스, 시스템마다 각각의 특성이 있기 때문에 정해진 것이 없다.

고려사항

- 마이크로 서비스를 어떻게 정의할 것인가?
- DB 접근 구조를 어떻게 설계할 것인가?
  - 일부의 비즈니스 트랜잭션은 여러 마이크로 서비스에 걸쳐 있어 각 서비스에 연결된 DB의 정합성을 보장해야한다.
- 마이크로 서비스 내API를 어떻게 설계할 것인가? etc

### 외부 아키텍처

External Gateway

외부 게이트웨이는 전체 서비스 외부로부터 들어오는 접근을, 내부 구조를 드러내지 않고 처리하기 위한 요소이다. 사용자 인증과 권한 정책 관리 등을 수행하며, API 게이트웨이가 가장 핵심적인 역할을 한다.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3b042a0d-e254-4a62-8609-19611186338b/Untitled.png)

Service Mesh

마이크로 서비스 구성요소 간의 네트워크를 제어하는 역할을 한다. 서비스 간에 통신을 하기 위해서는 service discovery, service routing, 트래픽 관리 및 보안을 담당하는 요소를 Service Mesh가 수행한다.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d3a1dead-4021-4467-936c-d986dc2c206e/Untitled.png)

Backing Service

애플리케이션이 실행되는 가운데, 네트워크를 통해서 사용할 수 있는 모든 서비스를 말하며, MySQL과 같은 DB, 캐시시스템, SMTP서비스등 애플리케이션과 통신하는 Attached 자원을 지칭하는 포괄적인 개념이다.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0d574d86-25bb-4694-911c-e273dd96d35b/Untitled.png)

Telemetry

MSA에서는 상당수의 마이크로 서비스가 분산 환경에서 운영되기 때문에 서비스의 상태를 일일이 모니터링하고 이슈에 대응하는 것이 어렵다. Telemetry는 서비스들을 모니터링하고 서비스 별로 발생하는 이슈에 대응할 수 있도록 환경을 구성하는 역할을 한다.

CI/CD Automation

지속적인 통합과 지속적인 배포를 자동화하는 것은 배포가 잦은 MSA 시스템에서 필요한 요소이다.